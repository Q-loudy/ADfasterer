{"ast":null,"code":"import { STUDY_TREE_LAYOUT_TYPE, TimeStudyTreeLayout } from \"./time-study-tree-layout\";\nimport DilationTimeStudy from \"./DilationTimeStudy\";\nimport ECTimeStudy from \"./ECTimeStudy\";\nimport EnslavedTimeStudy from \"./EnslavedTimeStudy\";\nimport HiddenTimeStudyConnection from \"./HiddenTimeStudyConnection\";\nimport NormalTimeStudy from \"./NormalTimeStudy\";\nimport PrimaryButton from \"@/components/PrimaryButton\";\nimport SecretTimeStudy from \"./SecretTimeStudy\";\nimport TimeStudyConnection from \"./TimeStudyConnection\";\nimport TriadTimeStudy from \"./TriadTimeStudy\";\nexport default {\n  name: \"TimeStudiesTab\",\n  components: {\n    PrimaryButton,\n    NormalTimeStudy,\n    ECTimeStudy,\n    EnslavedTimeStudy,\n    DilationTimeStudy,\n    TriadTimeStudy,\n    SecretTimeStudy,\n    TimeStudyConnection,\n    HiddenTimeStudyConnection\n  },\n\n  data() {\n    return {\n      respec: player.respec,\n      layoutType: STUDY_TREE_LAYOUT_TYPE.NORMAL,\n      vLevel: 0,\n      renderedStudyCount: 0,\n      renderedConnectionCount: 0,\n      isEnslaved: false,\n      delayTimer: 0\n    };\n  },\n\n  computed: {\n    layout() {\n      return TimeStudyTreeLayout.create(this.layoutType);\n    },\n\n    allStudies() {\n      return this.layout.studies;\n    },\n\n    studies() {\n      return this.allStudies.slice(0, this.renderedStudyCount);\n    },\n\n    allConnections() {\n      return this.layout.connections;\n    },\n\n    connections() {\n      return this.allConnections.slice(0, this.renderedConnectionCount);\n    },\n\n    treeStyleObject() {\n      return {\n        width: `${this.layout.width}rem`,\n        height: `${this.layout.height}rem`\n      };\n    },\n\n    respecClassObject() {\n      return {\n        \"o-primary-btn--subtab-option\": true,\n        \"o-primary-btn--respec-active\": this.respec\n      };\n    }\n\n  },\n  watch: {\n    respec(newValue) {\n      player.respec = newValue;\n    },\n\n    vLevel() {\n      // When vLevel changes, we recompute the study tree because of triad studies\n      this.$recompute(\"layout\");\n    }\n\n  },\n\n  created() {\n    const incrementRenderedCount = () => {\n      let shouldRequestNextFrame = false;\n\n      if (this.renderedStudyCount < this.allStudies.length) {\n        this.renderedStudyCount += 2;\n        shouldRequestNextFrame = true;\n      }\n\n      if (this.renderedConnectionCount < this.allConnections.length) {\n        this.renderedConnectionCount += 2;\n        shouldRequestNextFrame = true;\n      }\n\n      if (shouldRequestNextFrame) {\n        this.renderAnimationId = requestAnimationFrame(incrementRenderedCount);\n      }\n    };\n\n    incrementRenderedCount(); // CSS controlling the fade in/out for the Enslaved study is an animation happening over the course of 1 second.\n    // Removing it normally via key-switching ends up getting rid of it immediately without animating, which we do if it\n    // wasn't purchased - otherwise it animates to the unbought state and then remove it after the animation finishes.\n\n    this.on$(GAME_EVENT.REALITY_RESET_AFTER, () => {\n      this.delayTimer = player.celestials.enslaved.hasSecretStudy ? Date.now() : 0;\n    }); // Scroll to top because time studies tab is rendered progressively\n    // and we don't want the player to see empty space while it's loading.\n\n    document.body.scrollTop = 0;\n  },\n\n  beforeDestroy() {\n    cancelAnimationFrame(this.renderAnimationId);\n  },\n\n  methods: {\n    update() {\n      this.respec = player.respec;\n      this.layoutType = STUDY_TREE_LAYOUT_TYPE.current;\n      this.vLevel = Ra.pets.v.level;\n      this.isEnslaved = Enslaved.isRunning || Date.now() - this.delayTimer < 1000;\n    },\n\n    studyComponent(study) {\n      switch (study.type) {\n        case TIME_STUDY_TYPE.NORMAL:\n          return NormalTimeStudy;\n\n        case TIME_STUDY_TYPE.ETERNITY_CHALLENGE:\n          return ECTimeStudy;\n\n        case TIME_STUDY_TYPE.DILATION:\n          return DilationTimeStudy;\n\n        case TIME_STUDY_TYPE.TRIAD:\n          return TriadTimeStudy;\n      }\n\n      throw \"Unknown Time Study type\";\n    },\n\n    exportStudyTree() {\n      if (player.timestudy.studies.length === 0) {\n        GameUI.notify.error(\"You cannot export an empty Time Study Tree!\");\n      } else {\n        copyToClipboard(GameCache.currentStudyTree.value.exportString);\n        GameUI.notify.info(\"Exported current Time Studies to your clipboard\");\n      }\n    }\n\n  }\n};","map":{"version":3,"sources":["TimeStudiesTab.vue"],"names":[],"mappings":"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","sourcesContent":["<script>\r\nimport { STUDY_TREE_LAYOUT_TYPE, TimeStudyTreeLayout } from \"./time-study-tree-layout\";\r\n\r\nimport DilationTimeStudy from \"./DilationTimeStudy\";\r\nimport ECTimeStudy from \"./ECTimeStudy\";\r\nimport EnslavedTimeStudy from \"./EnslavedTimeStudy\";\r\nimport HiddenTimeStudyConnection from \"./HiddenTimeStudyConnection\";\r\nimport NormalTimeStudy from \"./NormalTimeStudy\";\r\nimport PrimaryButton from \"@/components/PrimaryButton\";\r\nimport SecretTimeStudy from \"./SecretTimeStudy\";\r\nimport TimeStudyConnection from \"./TimeStudyConnection\";\r\nimport TriadTimeStudy from \"./TriadTimeStudy\";\r\n\r\nexport default {\r\n  name: \"TimeStudiesTab\",\r\n  components: {\r\n    PrimaryButton,\r\n    NormalTimeStudy,\r\n    ECTimeStudy,\r\n    EnslavedTimeStudy,\r\n    DilationTimeStudy,\r\n    TriadTimeStudy,\r\n    SecretTimeStudy,\r\n    TimeStudyConnection,\r\n    HiddenTimeStudyConnection\r\n  },\r\n  data() {\r\n    return {\r\n      respec: player.respec,\r\n      layoutType: STUDY_TREE_LAYOUT_TYPE.NORMAL,\r\n      vLevel: 0,\r\n      renderedStudyCount: 0,\r\n      renderedConnectionCount: 0,\r\n      isEnslaved: false,\r\n      delayTimer: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    layout() {\r\n      return TimeStudyTreeLayout.create(this.layoutType);\r\n    },\r\n    allStudies() {\r\n      return this.layout.studies;\r\n    },\r\n    studies() {\r\n      return this.allStudies.slice(0, this.renderedStudyCount);\r\n    },\r\n    allConnections() {\r\n      return this.layout.connections;\r\n    },\r\n    connections() {\r\n      return this.allConnections.slice(0, this.renderedConnectionCount);\r\n    },\r\n    treeStyleObject() {\r\n      return {\r\n        width: `${this.layout.width}rem`,\r\n        height: `${this.layout.height}rem`\r\n      };\r\n    },\r\n    respecClassObject() {\r\n      return {\r\n        \"o-primary-btn--subtab-option\": true,\r\n        \"o-primary-btn--respec-active\": this.respec\r\n      };\r\n    }\r\n  },\r\n  watch: {\r\n    respec(newValue) {\r\n      player.respec = newValue;\r\n    },\r\n    vLevel() {\r\n      // When vLevel changes, we recompute the study tree because of triad studies\r\n      this.$recompute(\"layout\");\r\n    }\r\n  },\r\n  created() {\r\n    const incrementRenderedCount = () => {\r\n      let shouldRequestNextFrame = false;\r\n      if (this.renderedStudyCount < this.allStudies.length) {\r\n        this.renderedStudyCount += 2;\r\n        shouldRequestNextFrame = true;\r\n      }\r\n      if (this.renderedConnectionCount < this.allConnections.length) {\r\n        this.renderedConnectionCount += 2;\r\n        shouldRequestNextFrame = true;\r\n      }\r\n      if (shouldRequestNextFrame) {\r\n        this.renderAnimationId = requestAnimationFrame(incrementRenderedCount);\r\n      }\r\n    };\r\n    incrementRenderedCount();\r\n\r\n    // CSS controlling the fade in/out for the Enslaved study is an animation happening over the course of 1 second.\r\n    // Removing it normally via key-switching ends up getting rid of it immediately without animating, which we do if it\r\n    // wasn't purchased - otherwise it animates to the unbought state and then remove it after the animation finishes.\r\n    this.on$(GAME_EVENT.REALITY_RESET_AFTER, () => {\r\n      this.delayTimer = player.celestials.enslaved.hasSecretStudy\r\n        ? Date.now()\r\n        : 0;\r\n    });\r\n\r\n    // Scroll to top because time studies tab is rendered progressively\r\n    // and we don't want the player to see empty space while it's loading.\r\n    document.body.scrollTop = 0;\r\n  },\r\n  beforeDestroy() {\r\n    cancelAnimationFrame(this.renderAnimationId);\r\n  },\r\n  methods: {\r\n    update() {\r\n      this.respec = player.respec;\r\n      this.layoutType = STUDY_TREE_LAYOUT_TYPE.current;\r\n      this.vLevel = Ra.pets.v.level;\r\n      this.isEnslaved = Enslaved.isRunning || Date.now() - this.delayTimer < 1000;\r\n    },\r\n    studyComponent(study) {\r\n      switch (study.type) {\r\n        case TIME_STUDY_TYPE.NORMAL: return NormalTimeStudy;\r\n        case TIME_STUDY_TYPE.ETERNITY_CHALLENGE: return ECTimeStudy;\r\n        case TIME_STUDY_TYPE.DILATION: return DilationTimeStudy;\r\n        case TIME_STUDY_TYPE.TRIAD: return TriadTimeStudy;\r\n      }\r\n      throw \"Unknown Time Study type\";\r\n    },\r\n    exportStudyTree() {\r\n      if (player.timestudy.studies.length === 0) {\r\n        GameUI.notify.error(\"You cannot export an empty Time Study Tree!\");\r\n      } else {\r\n        copyToClipboard(GameCache.currentStudyTree.value.exportString);\r\n        GameUI.notify.info(\"Exported current Time Studies to your clipboard\");\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"l-time-studies-tab\">\r\n    <div class=\"c-subtab-option-container\">\r\n      <PrimaryButton\r\n        class=\"o-primary-btn--subtab-option\"\r\n        @click=\"exportStudyTree\"\r\n      >\r\n        Export tree\r\n      </PrimaryButton>\r\n      <PrimaryButton\r\n        :class=\"respecClassObject\"\r\n        @click=\"respec = !respec\"\r\n      >\r\n        Respec Time Studies on next Eternity\r\n      </PrimaryButton>\r\n      <PrimaryButton\r\n        class=\"o-primary-btn--subtab-option\"\r\n        onclick=\"Modal.studyString.show({ id: -1 })\"\r\n      >\r\n        Import tree\r\n      </PrimaryButton>\r\n    </div>\r\n    <div\r\n      class=\"l-time-study-tree l-time-studies-tab__tree\"\r\n      :style=\"treeStyleObject\"\r\n    >\r\n      <component\r\n        :is=\"studyComponent(setup.study)\"\r\n        v-for=\"(setup) in studies\"\r\n        :key=\"setup.study.type.toString() + setup.study.id.toString()\"\r\n        :setup=\"setup\"\r\n      />\r\n      <SecretTimeStudy :setup=\"layout.secretStudy\" />\r\n      <EnslavedTimeStudy\r\n        v-if=\"isEnslaved\"\r\n        :setup=\"layout.enslavedStudy\"\r\n      />\r\n      <svg\r\n        :style=\"treeStyleObject\"\r\n        class=\"l-time-study-connection\"\r\n      >\r\n        <TimeStudyConnection\r\n          v-for=\"(setup, index) in connections\"\r\n          :key=\"'connection' + index\"\r\n          :setup=\"setup\"\r\n        />\r\n        <HiddenTimeStudyConnection :setup=\"layout.secretStudyConnection\" />\r\n        <HiddenTimeStudyConnection\r\n          v-if=\"isEnslaved\"\r\n          :setup=\"layout.enslavedStudyConnection\"\r\n          :is-enslaved=\"isEnslaved\"\r\n        />\r\n      </svg>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n\r\n</style>\r\n"],"sourceRoot":"src/components/tabs/time-studies"},"metadata":{},"sourceType":"module"}