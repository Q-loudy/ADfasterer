{"ast":null,"code":"// TODO: remove before release\nexport function watchLatestCommit() {\n  if (isLocalEnvironment()) {\n    return;\n  }\n\n  const url = \"commit.json\";\n  let current;\n\n  function watch() {\n    fetch(url, {\n      method: \"GET\"\n    }).then(response => response.json()).then(json => {\n      var _current;\n\n      if (json === undefined) {\n        return;\n      }\n\n      current = (_current = current) !== null && _current !== void 0 ? _current : json.sha;\n\n      if (current === json.sha) {\n        return;\n      }\n\n      Modal.message.show(\"Refresh the page (game will be saved), we've got new stuff: \" + `\"${json.message}\" by ${json.author}`, {\n        callback: updateRefresh,\n        closeButton: true\n      }, 3);\n    });\n  }\n\n  setInterval(watch, 60000);\n}","map":{"version":3,"sources":["C:/Games/ADFasterer/ADfasterer/src/commit-watcher.js"],"names":["watchLatestCommit","isLocalEnvironment","url","current","watch","fetch","method","then","response","json","undefined","sha","Modal","message","show","author","callback","updateRefresh","closeButton","setInterval"],"mappings":"AAAA;AACA,OAAO,SAASA,iBAAT,GAA6B;AAClC,MAAIC,kBAAkB,EAAtB,EAA0B;AACxB;AACD;;AAED,QAAMC,GAAG,GAAG,aAAZ;AACA,MAAIC,OAAJ;;AAEA,WAASC,KAAT,GAAiB;AACfC,IAAAA,KAAK,CAACH,GAAD,EAAM;AAAEI,MAAAA,MAAM,EAAE;AAAV,KAAN,CAAL,CACGC,IADH,CACQC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EADpB,EAEGF,IAFH,CAEQE,IAAI,IAAI;AAAA;;AACZ,UAAIA,IAAI,KAAKC,SAAb,EAAwB;AACtB;AACD;;AACDP,MAAAA,OAAO,eAAGA,OAAH,+CAAcM,IAAI,CAACE,GAA1B;;AACA,UAAIR,OAAO,KAAKM,IAAI,CAACE,GAArB,EAA0B;AACxB;AACD;;AAEDC,MAAAA,KAAK,CAACC,OAAN,CAAcC,IAAd,CACE,iEACC,IAAGL,IAAI,CAACI,OAAQ,QAAOJ,IAAI,CAACM,MAAO,EAFtC,EAGE;AACEC,QAAAA,QAAQ,EAAEC,aADZ;AAEEC,QAAAA,WAAW,EAAE;AAFf,OAHF,EAOE,CAPF;AASD,KApBH;AAqBD;;AAEDC,EAAAA,WAAW,CAACf,KAAD,EAAQ,KAAR,CAAX;AACD","sourcesContent":["// TODO: remove before release\r\nexport function watchLatestCommit() {\r\n  if (isLocalEnvironment()) {\r\n    return;\r\n  }\r\n\r\n  const url = \"commit.json\";\r\n  let current;\r\n\r\n  function watch() {\r\n    fetch(url, { method: \"GET\" })\r\n      .then(response => response.json())\r\n      .then(json => {\r\n        if (json === undefined) {\r\n          return;\r\n        }\r\n        current = current ?? json.sha;\r\n        if (current === json.sha) {\r\n          return;\r\n        }\r\n\r\n        Modal.message.show(\r\n          \"Refresh the page (game will be saved), we've got new stuff: \" +\r\n          `\"${json.message}\" by ${json.author}`,\r\n          {\r\n            callback: updateRefresh,\r\n            closeButton: true\r\n          },\r\n          3\r\n        );\r\n      });\r\n  }\r\n\r\n  setInterval(watch, 60000);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}