{"ast":null,"code":"import \"core-js/modules/es.regexp.exec.js\";\nimport ModalWrapper from \"@/components/modals/ModalWrapper\";\nimport PrimaryButton from \"@/components/PrimaryButton\";\nexport default {\n  name: \"ModifySeedModal\",\n  components: {\n    ModalWrapper,\n    PrimaryButton\n  },\n\n  data() {\n    return {\n      mode: 0,\n      inputSeed: \"\",\n      seedText: \"\",\n      convertedInput: false,\n      seedValue: 0\n    };\n  },\n\n  computed: {\n    choiceEnum: () => SPEEDRUN_SEED_STATE,\n    officialSeed: () => Speedrun.officialFixedSeed\n  },\n\n  created() {\n    this.seedValue = player.speedrun.initialSeed;\n    this.inputSeed = `${player.speedrun.initialSeed}`;\n    this.convertedInput = false;\n  },\n\n  methods: {\n    update() {\n      this.mode = player.speedrun.seedSelection;\n      this.seedText = Speedrun.seedModeText();\n    },\n\n    handleSeedInput() {\n      if (this.inputSeed.match(/^\\x2D?[0-9]+$/g)) {\n        const num = Number(this.inputSeed);\n        this.seedValue = Math.abs(num) > 9e15 ? this.hashStringToSeed(this.inputSeed) : Number(this.inputSeed);\n      } else {\n        this.seedValue = this.hashStringToSeed(this.inputSeed);\n      }\n\n      this.convertedInput = this.seedValue !== Number(this.inputSeed);\n      if (this.seedValue === 0) this.setMode(this.choiceEnum.FIXED);else this.setMode(this.choiceEnum.PLAYER, this.seedValue);\n    },\n\n    setMode(mode, seed) {\n      if (mode === this.choiceEnum.PLAYER && this.seedValue === 0) return;\n      Speedrun.modifySeed(mode, parseInt(seed, 10));\n    },\n\n    buttonClass(mode) {\n      return {\n        \"o-primary-btn--subtab-option\": true,\n        \"o-selected\": mode === this.mode\n      };\n    },\n\n    // String-to-number hashing function, using a fixed numerical seed inspired by Number.MAX_VALUE\n    // See https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript\n    hashStringToSeed(str) {\n      const seed = 17977308;\n      let h1 = 0xdeadbeef ^ seed,\n          h2 = 0x41c6ce57 ^ seed;\n\n      for (let i = 0, ch; i < str.length; i++) {\n        ch = str.charCodeAt(i);\n        h1 = Math.imul(h1 ^ ch, 2654435761);\n        h2 = Math.imul(h2 ^ ch, 1597334677);\n      }\n\n      h1 = Math.imul(h1 ^ h1 >>> 16, 2246822507) ^ Math.imul(h2 ^ h2 >>> 13, 3266489909);\n      h2 = Math.imul(h2 ^ h2 >>> 16, 2246822507) ^ Math.imul(h1 ^ h1 >>> 13, 3266489909);\n      return 4294967296 * (2097151 & h2) + (h1 >>> 0);\n    }\n\n  }\n};","map":{"version":3,"sources":["ModifySeedModal.vue"],"names":[],"mappings":"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","sourcesContent":["<script>\r\nimport ModalWrapper from \"@/components/modals/ModalWrapper\";\r\nimport PrimaryButton from \"@/components/PrimaryButton\";\r\n\r\nexport default {\r\n  name: \"ModifySeedModal\",\r\n  components: {\r\n    ModalWrapper,\r\n    PrimaryButton,\r\n  },\r\n  data() {\r\n    return {\r\n      mode: 0,\r\n      inputSeed: \"\",\r\n      seedText: \"\",\r\n      convertedInput: false,\r\n      seedValue: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    choiceEnum: () => SPEEDRUN_SEED_STATE,\r\n    officialSeed: () => Speedrun.officialFixedSeed,\r\n  },\r\n  created() {\r\n    this.seedValue = player.speedrun.initialSeed;\r\n    this.inputSeed = `${player.speedrun.initialSeed}`;\r\n    this.convertedInput = false;\r\n  },\r\n  methods: {\r\n    update() {\r\n      this.mode = player.speedrun.seedSelection;\r\n      this.seedText = Speedrun.seedModeText();\r\n    },\r\n    handleSeedInput() {\r\n      if (this.inputSeed.match(/^-?\\d+$/gu)) {\r\n        const num = Number(this.inputSeed);\r\n        this.seedValue = Math.abs(num) > 9e15\r\n          ? this.hashStringToSeed(this.inputSeed)\r\n          : Number(this.inputSeed);\r\n      } else {\r\n        this.seedValue = this.hashStringToSeed(this.inputSeed);\r\n      }\r\n      this.convertedInput = this.seedValue !== Number(this.inputSeed);\r\n\r\n      if (this.seedValue === 0) this.setMode(this.choiceEnum.FIXED);\r\n      else this.setMode(this.choiceEnum.PLAYER, this.seedValue);\r\n    },\r\n    setMode(mode, seed) {\r\n      if (mode === this.choiceEnum.PLAYER && this.seedValue === 0) return;\r\n      Speedrun.modifySeed(mode, parseInt(seed, 10));\r\n    },\r\n    buttonClass(mode) {\r\n      return {\r\n        \"o-primary-btn--subtab-option\": true,\r\n        \"o-selected\": mode === this.mode,\r\n      };\r\n    },\r\n    // String-to-number hashing function, using a fixed numerical seed inspired by Number.MAX_VALUE\r\n    // See https://stackoverflow.com/questions/7616461/generate-a-hash-from-string-in-javascript\r\n    hashStringToSeed(str) {\r\n      const seed = 17977308;\r\n      let h1 = 0xdeadbeef ^ seed, h2 = 0x41c6ce57 ^ seed;\r\n      for (let i = 0, ch; i < str.length; i++) {\r\n        ch = str.charCodeAt(i);\r\n        h1 = Math.imul(h1 ^ ch, 2654435761);\r\n        h2 = Math.imul(h2 ^ ch, 1597334677);\r\n      }\r\n      h1 = Math.imul(h1 ^ (h1 >>> 16), 2246822507) ^ Math.imul(h2 ^ (h2 >>> 13), 3266489909);\r\n      h2 = Math.imul(h2 ^ (h2 >>> 16), 2246822507) ^ Math.imul(h1 ^ (h1 >>> 13), 3266489909);\r\n      return 4294967296 * (2097151 & h2) + (h1 >>> 0);\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<template>\r\n  <ModalWrapper>\r\n    <template #header>\r\n      Modifying Glyph RNG Seed\r\n    </template>\r\n    <div>\r\n      All Glyph options beyond the first Reality for an entire playthrough are randomly determined from the very\r\n      beginning, based on the value of an initial seed number. The role of this seed is that it chooses a single,\r\n      <i>particular</i> set of Glyph options for your playthrough. If you or anyone else chooses the same seed\r\n      in a different run, you will get the same options for Glyphs.\r\n      <br>\r\n      <br>\r\n      You can switch between these three options any point before you generate your first Glyph.\r\n      <br>\r\n      Current Setting: <b>{{ seedText }}</b>\r\n      <br>\r\n      <br>\r\n      <PrimaryButton\r\n        :class=\"buttonClass(choiceEnum.FIXED)\"\r\n        @click=\"setMode(choiceEnum.FIXED)\"\r\n      >\r\n        Official Preset Seed\r\n      </PrimaryButton>\r\n      <br>\r\n      This is the default option which chooses the seed <b>{{ officialSeed }}</b>. Anyone who\r\n      chooses to not modify the seed at all will get these Glyph options.\r\n      <br>\r\n      <br>\r\n      <PrimaryButton\r\n        :class=\"buttonClass(choiceEnum.RANDOM)\"\r\n        @click=\"setMode(choiceEnum.RANDOM)\"\r\n      >\r\n        Randomized Seed\r\n      </PrimaryButton>\r\n      <br>\r\n      This selects a completely randomized seed value, producing Glyph options which are very likely to be\r\n      different from anyone else's playthrough unless they intentionally choose the same value.\r\n      <br>\r\n      <br>\r\n      <PrimaryButton\r\n        v-tooltip=\"seedValue === 0 ? 'Input seed cannot be zero!' : ''\"\r\n        :class=\"buttonClass(choiceEnum.PLAYER)\"\r\n        @click=\"setMode(choiceEnum.PLAYER, seedValue)\"\r\n      >\r\n        Player-selected Seed:\r\n      </PrimaryButton>\r\n      <input\r\n        ref=\"inputSeed\"\r\n        v-model=\"inputSeed\"\r\n        type=\"text\"\r\n        class=\"c-modal-input\"\r\n        @input=\"handleSeedInput()\"\r\n      >\r\n      <br>\r\n      This option sets your seed to the value you type into the text box.\r\n      <br>\r\n      <span v-if=\"seedValue !== 0\">\r\n        Your current input will be {{ convertedInput ? \"converted to\" : \"used as\" }} the number <b>{{ seedValue }}</b>.\r\n      </span>\r\n      <span v-else>\r\n        Your current input {{ convertedInput ? \"converts to\" : \"is equal to\" }} <b>0</b>;\r\n        the seed will default to Official Preset.\r\n      </span>\r\n      <br>\r\n      For technical reasons, this value must be must be non-zero to be accepted.\r\n    </div>\r\n  </ModalWrapper>\r\n</template>\r\n\r\n<style scoped>\r\n.o-selected {\r\n  color: var(--color-text-inverted);\r\n  background-color: var(--color-good);\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/modals"},"metadata":{},"sourceType":"module"}