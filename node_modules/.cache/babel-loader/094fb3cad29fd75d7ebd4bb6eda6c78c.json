{"ast":null,"code":"export const END_STATE_MARKERS = {\n  // Tab zalgoification starts as soon as endState > 0\n  GAME_END: 1,\n  TAB_START_HIDE: 1.5,\n  INTERACTIVITY_DISABLED: 2.5,\n  FADE_AWAY: 2.5,\n  SAVE_DISABLED: 4,\n  END_NUMBERS: 4.2,\n  CREDITS_START: 4.5,\n  SHOW_NEW_GAME: 13.5,\n  SPECTATE_GAME: 13.9,\n  // The song is 3:04 and the credits increment by 1 every 20 seconds. Needs changing if the song is changed.\n  SONG_END: 13.7,\n  CREDITS_END: 14.5\n};\nexport const GameEnd = {\n  get endState() {\n    if (this.removeAdditionalEnd) return this.additionalEnd;\n    return Math.max((Math.log10(player.celestials.pelle.records.totalAntimatter.plus(1).log10() + 1) - 8.7) / (Math.log10(9e15) - 8.7) + this.additionalEnd, 0);\n  },\n\n  _additionalEnd: 0,\n\n  get additionalEnd() {\n    return player.isGameEnd || this.removeAdditionalEnd ? this._additionalEnd : 0;\n  },\n\n  set additionalEnd(x) {\n    this._additionalEnd = player.isGameEnd || this.removeAdditionalEnd ? x : 0;\n  },\n\n  removeAdditionalEnd: false,\n  creditsClosed: false,\n  creditsEverClosed: false,\n\n  gameLoop(diff) {\n    if (this.removeAdditionalEnd) {\n      this.additionalEnd -= Math.min(diff / 200, 0.5);\n\n      if (this.additionalEnd < 4) {\n        this.additionalEnd = 0;\n        this.removeAdditionalEnd = false;\n      }\n    }\n\n    if (!this.removeAdditionalEnd && this.endState >= END_STATE_MARKERS.GAME_END && ui.$viewModel.modal.progressBar === undefined) {\n      player.isGameEnd = true;\n      this.additionalEnd += Math.min(diff / 1000 / 20, 0.1);\n    }\n  }\n\n};","map":{"version":3,"sources":["C:/Games/ADFasterer/ADfasterer/src/core/celestials/pelle/game-end.js"],"names":["END_STATE_MARKERS","GAME_END","TAB_START_HIDE","INTERACTIVITY_DISABLED","FADE_AWAY","SAVE_DISABLED","END_NUMBERS","CREDITS_START","SHOW_NEW_GAME","SPECTATE_GAME","SONG_END","CREDITS_END","GameEnd","endState","removeAdditionalEnd","additionalEnd","Math","max","log10","player","celestials","pelle","records","totalAntimatter","plus","_additionalEnd","isGameEnd","x","creditsClosed","creditsEverClosed","gameLoop","diff","min","ui","$viewModel","modal","progressBar","undefined"],"mappings":"AAAA,OAAO,MAAMA,iBAAiB,GAAG;AAC/B;AACAC,EAAAA,QAAQ,EAAE,CAFqB;AAG/BC,EAAAA,cAAc,EAAE,GAHe;AAI/BC,EAAAA,sBAAsB,EAAE,GAJO;AAK/BC,EAAAA,SAAS,EAAE,GALoB;AAM/BC,EAAAA,aAAa,EAAE,CANgB;AAO/BC,EAAAA,WAAW,EAAE,GAPkB;AAQ/BC,EAAAA,aAAa,EAAE,GARgB;AAS/BC,EAAAA,aAAa,EAAE,IATgB;AAU/BC,EAAAA,aAAa,EAAE,IAVgB;AAW/B;AACAC,EAAAA,QAAQ,EAAE,IAZqB;AAa/BC,EAAAA,WAAW,EAAE;AAbkB,CAA1B;AAgBP,OAAO,MAAMC,OAAO,GAAG;AACrB,MAAIC,QAAJ,GAAe;AACb,QAAI,KAAKC,mBAAT,EAA8B,OAAO,KAAKC,aAAZ;AAC9B,WAAOC,IAAI,CAACC,GAAL,CAAS,CAACD,IAAI,CAACE,KAAL,CAAWC,MAAM,CAACC,UAAP,CAAkBC,KAAlB,CAAwBC,OAAxB,CAAgCC,eAAhC,CAAgDC,IAAhD,CAAqD,CAArD,EAAwDN,KAAxD,KAAkE,CAA7E,IAAkF,GAAnF,KACbF,IAAI,CAACE,KAAL,CAAW,IAAX,IAAmB,GADN,IACa,KAAKH,aAD3B,EAC0C,CAD1C,CAAP;AAED,GALoB;;AAOrBU,EAAAA,cAAc,EAAE,CAPK;;AAQrB,MAAIV,aAAJ,GAAoB;AAClB,WAAQI,MAAM,CAACO,SAAP,IAAoB,KAAKZ,mBAA1B,GAAiD,KAAKW,cAAtD,GAAuE,CAA9E;AACD,GAVoB;;AAWrB,MAAIV,aAAJ,CAAkBY,CAAlB,EAAqB;AACnB,SAAKF,cAAL,GAAuBN,MAAM,CAACO,SAAP,IAAoB,KAAKZ,mBAA1B,GAAiDa,CAAjD,GAAqD,CAA3E;AACD,GAboB;;AAerBb,EAAAA,mBAAmB,EAAE,KAfA;AAiBrBc,EAAAA,aAAa,EAAE,KAjBM;AAkBrBC,EAAAA,iBAAiB,EAAE,KAlBE;;AAoBrBC,EAAAA,QAAQ,CAACC,IAAD,EAAO;AACb,QAAI,KAAKjB,mBAAT,EAA8B;AAC5B,WAAKC,aAAL,IAAsBC,IAAI,CAACgB,GAAL,CAASD,IAAI,GAAG,GAAhB,EAAqB,GAArB,CAAtB;;AACA,UAAI,KAAKhB,aAAL,GAAqB,CAAzB,EAA4B;AAC1B,aAAKA,aAAL,GAAqB,CAArB;AACA,aAAKD,mBAAL,GAA2B,KAA3B;AACD;AACF;;AACD,QAAI,CAAC,KAAKA,mBAAN,IAA6B,KAAKD,QAAL,IAAiBb,iBAAiB,CAACC,QAAhE,IACAgC,EAAE,CAACC,UAAH,CAAcC,KAAd,CAAoBC,WAApB,KAAoCC,SADxC,EACmD;AACjDlB,MAAAA,MAAM,CAACO,SAAP,GAAmB,IAAnB;AACA,WAAKX,aAAL,IAAsBC,IAAI,CAACgB,GAAL,CAASD,IAAI,GAAG,IAAP,GAAc,EAAvB,EAA2B,GAA3B,CAAtB;AACD;AACF;;AAjCoB,CAAhB","sourcesContent":["export const END_STATE_MARKERS = {\r\n  // Tab zalgoification starts as soon as endState > 0\r\n  GAME_END: 1,\r\n  TAB_START_HIDE: 1.5,\r\n  INTERACTIVITY_DISABLED: 2.5,\r\n  FADE_AWAY: 2.5,\r\n  SAVE_DISABLED: 4,\r\n  END_NUMBERS: 4.2,\r\n  CREDITS_START: 4.5,\r\n  SHOW_NEW_GAME: 13.5,\r\n  SPECTATE_GAME: 13.9,\r\n  // The song is 3:04 and the credits increment by 1 every 20 seconds. Needs changing if the song is changed.\r\n  SONG_END: 13.7,\r\n  CREDITS_END: 14.5,\r\n};\r\n\r\nexport const GameEnd = {\r\n  get endState() {\r\n    if (this.removeAdditionalEnd) return this.additionalEnd;\r\n    return Math.max((Math.log10(player.celestials.pelle.records.totalAntimatter.plus(1).log10() + 1) - 8.7) /\r\n      (Math.log10(9e15) - 8.7) + this.additionalEnd, 0);\r\n  },\r\n\r\n  _additionalEnd: 0,\r\n  get additionalEnd() {\r\n    return (player.isGameEnd || this.removeAdditionalEnd) ? this._additionalEnd : 0;\r\n  },\r\n  set additionalEnd(x) {\r\n    this._additionalEnd = (player.isGameEnd || this.removeAdditionalEnd) ? x : 0;\r\n  },\r\n\r\n  removeAdditionalEnd: false,\r\n\r\n  creditsClosed: false,\r\n  creditsEverClosed: false,\r\n\r\n  gameLoop(diff) {\r\n    if (this.removeAdditionalEnd) {\r\n      this.additionalEnd -= Math.min(diff / 200, 0.5);\r\n      if (this.additionalEnd < 4) {\r\n        this.additionalEnd = 0;\r\n        this.removeAdditionalEnd = false;\r\n      }\r\n    }\r\n    if (!this.removeAdditionalEnd && this.endState >= END_STATE_MARKERS.GAME_END &&\r\n        ui.$viewModel.modal.progressBar === undefined) {\r\n      player.isGameEnd = true;\r\n      this.additionalEnd += Math.min(diff / 1000 / 20, 0.1);\r\n    }\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}