{"remainingRequest":"C:\\Games\\ADFasterer\\ADfasterer\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js??vue-loader-options!C:\\Games\\ADFasterer\\ADfasterer\\src\\components\\tabs\\speedrun-milestones\\PreviousSpeedrunTab.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Games\\ADFasterer\\ADfasterer\\src\\components\\tabs\\speedrun-milestones\\PreviousSpeedrunTab.vue","mtime":1745241597441},{"path":"C:\\Games\\ADFasterer\\ADfasterer\\node_modules\\babel-loader\\lib\\index.js","mtime":1745242219290},{"path":"C:\\Games\\ADFasterer\\ADfasterer\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1745242214069},{"path":"C:\\Games\\ADFasterer\\ADfasterer\\node_modules\\@vue\\vue-loader-v15\\lib\\index.js","mtime":1745242220175}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQppbXBvcnQgUHJldmlvdXNTcGVlZHJ1bkluZm8gZnJvbSAiLi9QcmV2aW91c1NwZWVkcnVuSW5mbyI7DQppbXBvcnQgUHJpbWFyeUJ1dHRvbiBmcm9tICJAL2NvbXBvbmVudHMvUHJpbWFyeUJ1dHRvbiI7DQppbXBvcnQgU3BlZWRydW5NaWxlc3RvbmVDb21wYXJlIGZyb20gIi4vU3BlZWRydW5NaWxlc3RvbmVDb21wYXJlIjsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAiUHJldmlvdXNTcGVlZHJ1blRhYiIsDQogIGNvbXBvbmVudHM6IHsNCiAgICBQcmltYXJ5QnV0dG9uLA0KICAgIFNwZWVkcnVuTWlsZXN0b25lQ29tcGFyZSwNCiAgICBQcmV2aW91c1NwZWVkcnVuSW5mbywNCiAgfSwNCiAgZGF0YSgpIHsNCiAgICByZXR1cm4gew0KICAgICAgbWlsZXN0b25lVGltZXM6IFtdLA0KICAgICAgaXNTcGVjdGF0aW5nOiBmYWxzZSwNCiAgICAgIHNlbGVjdGVkUnVuOiAwLA0KICAgICAgcnVuUGFnZTogMCwNCiAgICB9Ow0KICB9LA0KICBjb21wdXRlZDogew0KICAgIG1pbGVzdG9uZXM6ICgpID0+IEdhbWVEYXRhYmFzZS5zcGVlZHJ1bk1pbGVzdG9uZXMsDQogICAgcHJldmlvdXNSdW5zKCkgew0KICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHBsYXllci5zcGVlZHJ1bi5wcmV2aW91c1J1bnMpOw0KICAgICAgY29uc3QgYWxsUnVucyA9IFtdOw0KICAgICAgZm9yIChjb25zdCBrZXkgb2Yga2V5cykgew0KICAgICAgICBjb25zdCBydW4gPSBwbGF5ZXIuc3BlZWRydW4ucHJldmlvdXNSdW5zW2tleV07DQogICAgICAgIHJ1bi5pZCA9IE51bWJlcihrZXkpOw0KICAgICAgICBhbGxSdW5zLnB1c2gocnVuKTsNCiAgICAgIH0NCiAgICAgIHJldHVybiBhbGxSdW5zOw0KICAgIH0sDQogICAgYmVzdFByZXZpb3VzVGltZXMoKSB7DQogICAgICBjb25zdCByZWNMZW5ndGggPSBHYW1lRGF0YWJhc2Uuc3BlZWRydW5NaWxlc3RvbmVzLmxlbmd0aCArIDE7DQogICAgICBjb25zdCBiZXN0VGltZXMgPSBBcnJheS5yZXBlYXQoMCwgcmVjTGVuZ3RoKTsNCiAgICAgIGNvbnN0IGJlc3RSdW5JbmRpY2VzID0gWy4uLmJlc3RUaW1lc107DQogICAgICBmb3IgKGNvbnN0IGluZGV4IG9mIE9iamVjdC5rZXlzKHBsYXllci5zcGVlZHJ1bi5wcmV2aW91c1J1bnMpKSB7DQogICAgICAgIGNvbnN0IHJ1biA9IHBsYXllci5zcGVlZHJ1bi5wcmV2aW91c1J1bnNbaW5kZXhdLnJlY29yZHM7DQogICAgICAgIGZvciAobGV0IHJlYyA9IDA7IHJlYyA8IHJlY0xlbmd0aDsgcmVjKyspIHsNCiAgICAgICAgICBpZiAocnVuW3JlY10gIT09IDAgJiYgKHJ1bltyZWNdIDwgYmVzdFRpbWVzW3JlY10gfHwgYmVzdFRpbWVzW3JlY10gPT09IDApKSB7DQogICAgICAgICAgICBiZXN0VGltZXNbcmVjXSA9IHJ1bltyZWNdOw0KICAgICAgICAgICAgYmVzdFJ1bkluZGljZXNbcmVjXSA9IGluZGV4Ow0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICBjb25zdCBtaWxlc3RvbmVMaXN0ID0gQXJyYXkucmVwZWF0KHt9LCByZWNMZW5ndGgpOw0KICAgICAgZm9yIChsZXQgcmVjID0gMDsgcmVjIDwgcmVjTGVuZ3RoOyByZWMrKykgew0KICAgICAgICBtaWxlc3RvbmVMaXN0W3JlY10gPSB7IHRpbWU6IGJlc3RUaW1lc1tyZWNdLCBpbmRleDogYmVzdFJ1bkluZGljZXNbcmVjXSB9Ow0KICAgICAgfQ0KICAgICAgcmV0dXJuIG1pbGVzdG9uZUxpc3Q7DQogICAgfSwNCiAgICBudW1SdW5zKCkgew0KICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMucHJldmlvdXNSdW5zKS5sZW5ndGg7DQogICAgfSwNCiAgICBoaWdoZXN0SW5kZXgoKSB7DQogICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5wcmV2aW91c1J1bnMubWFwKGsgPT4gTnVtYmVyKGsuaWQpKS5tYXgoKSwgcGxheWVyLnJlY29yZHMuZnVsbEdhbWVDb21wbGV0aW9ucyk7DQogICAgfSwNCiAgICBzcGVjdGF0ZVRleHQoKSB7DQogICAgICByZXR1cm4gdGhpcy5pc1NwZWN0YXRpbmcNCiAgICAgICAgPyAiTnVtYmVycyBoZXJlIGFyZSB1bmFmZmVjdGVkIGJ5IEVORCBzbyB0aGF0IHlvdSBjYW4gc2VlIHlvdXIgZmluYWwgcmVjb3Jkcy4iDQogICAgICAgIDogbnVsbDsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICB1cGRhdGUoKSB7DQogICAgICB0aGlzLm1pbGVzdG9uZVRpbWVzID0gWy4uLnBsYXllci5zcGVlZHJ1bi5yZWNvcmRzXTsNCiAgICAgIHRoaXMuaXNTcGVjdGF0aW5nID0gR2FtZUVuZC5lbmRTdGF0ZSA+IEVORF9TVEFURV9NQVJLRVJTLlNQRUNUQVRFX0dBTUU7DQogICAgfSwNCiAgICBzZWxlY3RSdW4oaW5kZXgpIHsNCiAgICAgIHRoaXMuc2VsZWN0ZWRSdW4gPSBpbmRleDsNCiAgICB9LA0KICAgIGZpbmRSdW4oaW5kZXgpIHsNCiAgICAgIHJldHVybiB0aGlzLnByZXZpb3VzUnVucy5maW5kKHIgPT4gcj8uaWQgPT09IDEwICogdGhpcy5ydW5QYWdlICsgaW5kZXgpOw0KICAgIH0sDQogICAgY2hhbmdlUGFnZShkaXIpIHsNCiAgICAgIHRoaXMucnVuUGFnZSA9IE1hdGguY2xhbXAodGhpcy5ydW5QYWdlICsgZGlyLCAwLCBNYXRoLmZsb29yKHRoaXMuaGlnaGVzdEluZGV4IC8gMTApKTsNCiAgICB9DQogIH0sDQp9Ow0K"},{"version":3,"sources":["PreviousSpeedrunTab.vue"],"names":[],"mappings":";AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"PreviousSpeedrunTab.vue","sourceRoot":"src/components/tabs/speedrun-milestones","sourcesContent":["<script>\r\nimport PreviousSpeedrunInfo from \"./PreviousSpeedrunInfo\";\r\nimport PrimaryButton from \"@/components/PrimaryButton\";\r\nimport SpeedrunMilestoneCompare from \"./SpeedrunMilestoneCompare\";\r\n\r\nexport default {\r\n  name: \"PreviousSpeedrunTab\",\r\n  components: {\r\n    PrimaryButton,\r\n    SpeedrunMilestoneCompare,\r\n    PreviousSpeedrunInfo,\r\n  },\r\n  data() {\r\n    return {\r\n      milestoneTimes: [],\r\n      isSpectating: false,\r\n      selectedRun: 0,\r\n      runPage: 0,\r\n    };\r\n  },\r\n  computed: {\r\n    milestones: () => GameDatabase.speedrunMilestones,\r\n    previousRuns() {\r\n      const keys = Object.keys(player.speedrun.previousRuns);\r\n      const allRuns = [];\r\n      for (const key of keys) {\r\n        const run = player.speedrun.previousRuns[key];\r\n        run.id = Number(key);\r\n        allRuns.push(run);\r\n      }\r\n      return allRuns;\r\n    },\r\n    bestPreviousTimes() {\r\n      const recLength = GameDatabase.speedrunMilestones.length + 1;\r\n      const bestTimes = Array.repeat(0, recLength);\r\n      const bestRunIndices = [...bestTimes];\r\n      for (const index of Object.keys(player.speedrun.previousRuns)) {\r\n        const run = player.speedrun.previousRuns[index].records;\r\n        for (let rec = 0; rec < recLength; rec++) {\r\n          if (run[rec] !== 0 && (run[rec] < bestTimes[rec] || bestTimes[rec] === 0)) {\r\n            bestTimes[rec] = run[rec];\r\n            bestRunIndices[rec] = index;\r\n          }\r\n        }\r\n      }\r\n\r\n      const milestoneList = Array.repeat({}, recLength);\r\n      for (let rec = 0; rec < recLength; rec++) {\r\n        milestoneList[rec] = { time: bestTimes[rec], index: bestRunIndices[rec] };\r\n      }\r\n      return milestoneList;\r\n    },\r\n    numRuns() {\r\n      return Object.keys(this.previousRuns).length;\r\n    },\r\n    highestIndex() {\r\n      return Math.max(this.previousRuns.map(k => Number(k.id)).max(), player.records.fullGameCompletions);\r\n    },\r\n    spectateText() {\r\n      return this.isSpectating\r\n        ? \"Numbers here are unaffected by END so that you can see your final records.\"\r\n        : null;\r\n    }\r\n  },\r\n  methods: {\r\n    update() {\r\n      this.milestoneTimes = [...player.speedrun.records];\r\n      this.isSpectating = GameEnd.endState > END_STATE_MARKERS.SPECTATE_GAME;\r\n    },\r\n    selectRun(index) {\r\n      this.selectedRun = index;\r\n    },\r\n    findRun(index) {\r\n      return this.previousRuns.find(r => r?.id === 10 * this.runPage + index);\r\n    },\r\n    changePage(dir) {\r\n      this.runPage = Math.clamp(this.runPage + dir, 0, Math.floor(this.highestIndex / 10));\r\n    }\r\n  },\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"c-previous-runs\">\r\n    <b>You have completed {{ quantify(\"speedrun\", numRuns, 0, 0, x => x) }} prior to this playthrough.</b>\r\n    <b>Statistics of previous runs are below, mouseover icons for more details.</b>\r\n    <b>Click the magnifying glass to compare the milestones on a particular run to this run.</b>\r\n    <b>{{ spectateText }}</b>\r\n    <br>\r\n    <div\r\n      v-if=\"highestIndex > 10\"\r\n      class=\"c-run-page-nav\"\r\n    >\r\n      <PrimaryButton\r\n        class=\"o-primary-btn--subtab-option fas fa-arrow-left\"\r\n        :class=\"{ 'o-primary-btn--disabled' : runPage === 0 }\"\r\n        @click=\"changePage(-1)\"\r\n      />\r\n      Showing runs {{ 10 * runPage + 1 }} to {{ 10 * (runPage + 1) }} ({{ highestIndex }} total runs)\r\n      <PrimaryButton\r\n        class=\"o-primary-btn--subtab-option fas fa-arrow-right\"\r\n        :class=\"{ 'o-primary-btn--disabled' : runPage + 1 > highestIndex / 10 }\"\r\n        @click=\"changePage(1)\"\r\n      />\r\n    </div>\r\n    <div class=\"c-previous-runs\">\r\n      <span\r\n        v-for=\"entry in 10\"\r\n        :key=\"entry\"\r\n      >\r\n        <span\r\n          v-if=\"10 * runPage + entry <= highestIndex\"\r\n          class=\"c-single-run\"\r\n        >\r\n          <PrimaryButton\r\n            v-if=\"findRun(entry)\"\r\n            class=\"o-primary-btn--subtab-option fas fa-magnifying-glass\"\r\n            :class=\"{ 'o-selected-btn' : selectedRun === 10 * runPage + entry }\"\r\n            @click=\"selectRun(10 * runPage + entry)\"\r\n          />\r\n          <PreviousSpeedrunInfo\r\n            :prev-run-info=\"findRun(entry)\"\r\n            :index=\"10 * runPage + entry\"\r\n          />\r\n        </span>\r\n      </span>\r\n    </div>\r\n    <br>\r\n    <div class=\"c-legend\">\r\n      <div class=\"c-legend-cell\">\r\n        <span class=\"o-box l-milestone-none\" /> Not reached this run\r\n      </div>\r\n      <div class=\"c-legend-cell\">\r\n        <span class=\"o-box l-milestone-slow\" /> Slower than comparison\r\n      </div>\r\n      <div class=\"c-legend-cell\">\r\n        <span class=\"o-box l-milestone-fast\" /> Faster than comparison\r\n      </div>\r\n      <div class=\"c-legend-cell\">\r\n        <span class=\"o-box l-milestone-fastest\" /> Faster than best\r\n      </div>\r\n    </div>\r\n    <div class=\"l-speedrun-milestone-tab\">\r\n      <SpeedrunMilestoneCompare\r\n        v-for=\"milestone in milestones\"\r\n        :key=\"milestone.id\"\r\n        :milestone=\"milestone\"\r\n        :curr-time=\"milestoneTimes[milestone.id]\"\r\n        :ref-time=\"selectedRun ? previousRuns.find(run => run.id === selectedRun).records[milestone.id] : null\"\r\n        :best-time=\"bestPreviousTimes[milestone.id].time\"\r\n        :run-indices=\"[selectedRun, bestPreviousTimes[milestone.id].index]\"\r\n      />\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n.c-run-page-nav {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  font-size: 1.3rem;\r\n  width: 60rem;\r\n}\r\n\r\n.c-previous-runs {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  color: var(--color-text);\r\n}\r\n\r\n.c-single-run {\r\n  display: flex;\r\n  flex-direction: row;\r\n  padding: 0.5rem;\r\n  border: 0.1rem solid;\r\n  width: 100rem;\r\n}\r\n\r\n.o-selected-btn {\r\n  background-color: var(--color-good);\r\n}\r\n\r\n.c-legend {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-around;\r\n  align-items: center;\r\n  width: 95rem;\r\n}\r\n\r\n.c-legend-cell {\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: flex-start;\r\n  align-items: center;\r\n  width: 30rem;\r\n  font-size: 1.5rem;\r\n}\r\n\r\n.o-box {\r\n  display: grid;\r\n  width: 2rem;\r\n  height: 2rem;\r\n  margin: 0.3rem;\r\n  border: var(--var-border-width, 0.2rem) solid var(--color-text);\r\n  border-radius: var(--var-border-radius, 0.5rem);\r\n}\r\n\r\n.l-milestone-none {\r\n  background-color: var(--color-base);\r\n}\r\n\r\n.l-milestone-slow {\r\n  background-color: var(--color-bad);\r\n}\r\n\r\n.l-milestone-fast {\r\n  background-color: var(--color-good);\r\n}\r\n\r\n.l-milestone-fastest {\r\n  background-color: var(--color-celestials);\r\n}\r\n</style>\r\n"]}]}